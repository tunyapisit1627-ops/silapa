@{
  ViewData["Title"] = "งานศิลปหัตถกรรมนักเรียนครั้งที่ 73 ปีการศึกษา 2568 จังหวัดนครราชสีมา";
  IList<news> news = ViewBag.news;
  IList<Competitionlist> competitionData = ViewBag.competitionData;
  IList<category> datacategory = ViewBag.datacategory;
  IList<racedetails> datarace = ViewBag.datarace;
  int n = 1;
  int index = 0; // ตัวนับรอบ
  System.Globalization.CultureInfo thaiCulture = new System.Globalization.CultureInfo("th-TH");
  string[] pastelColors = { "card-pastel-pink", "card-pastel-blue", "card-pastel-green", "card-pastel-yellow" };
}
<br/>
<button type="button" class="btn btn-info btn-lg btn-block"
  onclick="goToFrmExamine()">ค้นหา/ดาวน์โหลดเกียรติบัตร</button>
<!-- xxxxx -->
<div class="container">
  <div class="row">
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="card card-danger">
      <div class="card-header">
        <h3 class="card-title">ยอดผู้เข้าแข่งขันในแต่ละศูนย์</h3>

        <div class="card-tools">
          <button type="button" class="btn btn-tool" data-card-widget="collapse">
            <i class="fas fa-minus"></i>
          </button>
          <button type="button" class="btn btn-tool" data-card-widget="remove">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="card-body">
        <canvas id="pieChart" style="min-height: 350px; height: 350px; max-height: 350px; max-width: 100%;"></canvas>
      </div>
      <!-- /.card-body -->
    </div>
  </div>
</div>
<div class="modal fade" id="modal-xl" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalLabel">ข้อมูลเพิ่มเติม</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>กำลังโหลดข้อมูล...</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Template -->
<div class="modal fade" id="resultsModal" tabindex="-1" role="dialog" aria-labelledby="resultsModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="resultsModalLabel">รายการที่ยังไม่ประกาศผล</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="resultsContainer">
          <!-- รายการจะแสดงที่นี่ -->
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
      </div>
    </div>
  </div>
</div>

<script src="~/plugins/jquery/jquery.min.js"></script>
<script>
  $(function () {

    $.ajax({
      url: '/api/ChartData/GetPieChartData',
      method: 'GET',
      success: function (response) {
        var pieChartCanvas = $('#pieChart').get(0).getContext('2d');

        // ใช้ข้อมูลจาก API ในการสร้างกราฟ
        new Chart(pieChartCanvas, {
          type: 'pie',
          data: {
            labels: response.labels,
            datasets: response.datasets
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: true
              }
            }
          }
        });
      },
      error: function (error) {
        console.error('Error loading data:', error);
      }
    });
  });
</script>
<script>

  $(document).ready(function () {
    document.getElementById("openModal").addEventListener("click", function () {
      // โหลดข้อมูลจากเซิร์ฟเวอร์
      fetch('/Home/genshowlistrefect') // เรียก Action ใน Controller
        .then(response => response.text()) // รับข้อมูลเป็น HTML
        .then(data => {
          // ใส่ข้อมูลใน modal-body
          document.querySelector("#modal-xl .modal-body").innerHTML = data;
        })
        .catch(error => {
          console.error('Error loading modal data:', error);
          document.querySelector("#modal-xl .modal-body").innerHTML = "เกิดข้อผิดพลาดในการโหลดข้อมูล.";
        });
    });
  });
  function goToNewsAll(event) {
    if (event) {
      event.preventDefault(); // ป้องกันการรีเฟรช
    }
    console.log('Navigating to News All...');
    window.location.href = '/Home/frmnewsAll'; // ตัวอย่างเปลี่ยนหน้าไปยัง URL ใหม่
  }
  document.getElementById("showResultsLink").addEventListener("click", function () {
    fetch('/Home/GetSummaryResults')
      .then(response => response.json())
      .then(data => {
        let container = document.getElementById("resultsContainer");
        container.innerHTML = ""; // ล้างข้อมูลเก่า

        if (data.length === 0) {
          container.innerHTML = "<p>ไม่มีข้อมูล</p>";
        } else {
          let list = "<ul>";
          data.forEach(item => {
            list += `<li>${item.name}</li>`;
          });
          list += "</ul>";
          container.innerHTML = list;
        }

        // เปิด Modal
        let modal = new bootstrap.Modal(document.getElementById('resultsModal'));
        modal.show();
      })
      .catch(error => {
        console.error("Error:", error);
      });
  });
  function goToFrmExamine() {
    var url = '@Url.Action("frmexamine", "Home")';
    window.location.href = url;
  }
</script>
<style>
  .carousel-inner {
    height: 400px;
    /* กำหนดความสูงของ Carousel */
  }

  .carousel-img {
    height: 100%;
    object-fit: cover;
    /* ทำให้ภาพปรับขนาดครอบคลุมคอนเทนเนอร์ */
  }

  .card-pastel-pink {
    background-color: #FFD1DC;
    /* สีชมพูพาสเทล */
    border: 1px solid #FFC0CB;
  }

  .card-pastel-blue {
    background-color: #CFE2F3;
    /* สีฟ้าพาสเทล */
    border: 1px solid #B0C4DE;
  }

  .card-pastel-green {
    background-color: #D5E8D4;
    /* สีเขียวพาสเทล */
    border: 1px solid #A9DFBF;
  }

  .card-pastel-yellow {
    background-color: #FFF9C4;
    /* สีเหลืองพาสเทล */
    border: 1px solid #FFEB3B;
  }
</style>